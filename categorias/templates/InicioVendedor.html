{% extends "base_login.html" %}
        
{% block title %}
<title>Mi sesion vendedor</title>
{% endblock %}

{% block funciones %}
{% load static %}
<script src="{% static 'js/funciones1.js' %}"></script>
{% endblock %}

{% block content %}
  {% load static %}
  {% load crispy_forms_tags %}
  {% load humanize %}

        <div class="row cuerpo2">
            <div class="col-12 col-md-6 mb-2">
                <div class="c2">
                    <form id="lista">
                    <div class="titulos-tarjetas">
                        <h4>Listado de Productos</h4>
                    </div>
                    <div class="busqueda">
                        <div class="row-mini3">
                            <input type="text" class="form-control" id="busqueda">
                        </div>
                        <div class="row-mini4">
                            <button type="submit" class="btn btn-primary"><a href="Productos.html">Buscar</a></button>
                        </div>
                    </div>
                    <div class="datagrid">
                        <table class="table table-striped table-hover table-responsive-sm">
                            <tr>
                                <th></th>
                                <th data-field="id">ID</th>
                                <th>Nombre</th>
                                <th>Precio</th> 
                                <th>Descripción </th> 
                                <th>Unidad Medida</th>  
                                <th>Categoría</th>
                                <th>Vendedor</th>                
                            </tr>
                           

                            {% for i in productos %}
                          
                            <tr>
                                <td class="bs-checkbox " style="width: 36px; "><label>
                                    <input data-index="{{ i.id_producto | title }}" name="id" type="radio" value="{{ i.id_producto | title }}">
                                    <span></span>
                                    </label></td>
                                <td>{{ i.id_producto | title }}</td>
                                <td>{{ i.nombre_producto | title }}</td>
                                <td>{{ i.precio_producto | intcomma }}</td>
                                <td>{{ i.descripcion_producto  | title }}</td>
                                <td>{{ i.unidad_medida | title }}</td>
                                <td>{{ i.categoria | title }}</td>
                                <td>{{ i.vendedor | title }}</td>
                                
                            </tr>
                            {% endfor %}
                        </table>
                    </div>
                    <div class="botones">
                        <div class="row-mini5">
                            <a class="btn btn-primary" onclick="$('#modalcrear').modal('show');">Añadir</a>
                        </div>
                        <div class="row-mini5">
                            <button class="btn btn-primary" onclick="$('#tipo').val('1')">Editar</a></button>
                        </div>
                        <div class="row-mini5">
                            <button class="btn btn-primary"><a onclick="$('#tipo').val('0')">Eliminar</a></button>
                        </div>
                    </div>
                </form>
                <input type="text" class="d-none" id="tipo">
                </div>         
            </div>

            <div class="col-12 col-md-6 mb-2">
                <div class="c3">
                    <div class="titulos-tarjetas">
                        <h4>Listado de Pedidos</h4>
                    </div>
                    <div>
                        <div class="datagrid">
                            <table class="table table-striped table-hover table-responsive-sm" data-id-field="id" data-select-item-name="id">
                                <tr>
                                    <th></th>
                                    <th>ID</th>
                                    <th>Cantidad Producto</th>
                                    <th>Monto Total</th> 
                                    <th>Hora </th> 
                                    <th>Comprador</th>  
                                    <th>Producto</th>
                                    

                                </tr>
                               
    
                                {% for j in pedidos %}
                                <tr>
                                    <td class="bs-checkbox " style="width: 36px; "><label>
                                    <input data-index="{{ j.id_compra | title }}" name="id" type="radio" value="{{ j.id_compra | title }}">
                                    <span></span>
                                    </label></td>
                                    <td>{{ j.id_compra | title }}</td>
                                    <td>{{ j.cant_prod | title }}</td>
                                    <td>{{ j.monto_total | intcomma }}</td>
                                    <td>{{ j.hora_compra  | naturaltime }}</td>
                                    <td>{{ j.comprador | title }}</td>
                                    <td>{{ j.producto | title }}</td>
                                    
                                </tr>
                                {% endfor %}
                            </table>
                         
                        </div>
                        <div class="botones">
                            <div class="row-mini6">
                                <button type="submit" class="btn btn-primary"><a href="Productos.html">Ordenar</a></button>
                            </div>
                            <div class="row-mini6">
                                <button type="submit" class="btn btn-primary"><a href="Productos.html">Ver Historial</a></button>
                            </div>
                        </div>
                    </div>
                </div>          
            </div>
        </div>
     
<div class="modal" tabindex="-1" id="modaleditar">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Modificar {{form.nombre_producto.value}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form method="post" action="../../Modificar-producto/{{productoid}}/" enctype="multipart/form-data">
       <div class="modal-body">
        {% csrf_token %}
        {{ form | crispy }}
       </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
      </form> 
    </div>
  </div>
</div>

<div class="modal" tabindex="-1" id="modalcrear">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Crear Producto</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form method="post" action="../../InicioVendedor/" enctype="multipart/form-data">
       <div class="modal-body">
        {% csrf_token %}
        {{ form | crispy }}
       </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
      </form> 
    </div>
  </div>
</div>
          

        <script type="text/javascript">
            $(function () {
                $("#tipo").change( function() {
                    $('#lista').submit();
                });
                {% if form.nombre_producto.value %}
                $('#modaleditar').modal('show');
                {% endif %}
                $('#lista').submit(function (tipo) {
                    if ($("#tipo").val() == "1") {
                        window.location.replace("../../../Editar-producto/" + $(this).serializeArray()[0]["value"] + "/");
                    } else {
                        window.location.replace("../../../Eliminar-producto/" + $(this).serializeArray()[0]["value"] + "/");
                    }
                  return false;
                });
            });
        </script>

        {% endblock %}